%
% Copyright © 2015 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{shoExpectations}
%\renewcommand{\dirname}{notes/phy1520/}
%%\newcommand{\dateintitle}{}
%%\newcommand{\keywords}{}
%
%\input{../peeter_prologue_print2.tex}
%
%\usepackage{peeters_layout_exercise}
%\usepackage{peeters_braket}
%\usepackage{peeters_figures}
%
%\beginArtNoToc
%
%\generatetitle{Expectations for SHO Hamiltonian, and virial theorem.}
%%\label{chap:shoExpectations}

\makeoproblem{Expectations for SHO Hamiltonian, and virial theorem.}{problem:shoExpectations:1}{\citep{sakurai2014modern} pr. 2.14}{
\index{harmonic oscillator}
\index{virial theorem}
\makesubproblem{}{problem:shoExpectations:1:a}

For a 1D SHO, compute \(
\bra{m} x \ket{n},
\bra{m} x^2 \ket{n},
\bra{m} p \ket{n},
\bra{m} p^2 \ket{n} \) and \( \bra{m} \symmetric{x}{p} \ket{n} \).

\makesubproblem{}{problem:shoExpectations:1:b}

Verify the virial theorem is satisfied for energy eigenstates.
} % problem

\makeanswer{problem:shoExpectations:1}{

\makeSubAnswer{}{problem:shoExpectations:1:a}

Using

\begin{equation}\label{eqn:shoExpectations:20}
\begin{aligned}
x &= \frac{x_0}{\sqrt{2}} \lr{ a + a^\dagger } \\
p &= \frac{i\Hbar}{x_0 \sqrt{2}} \lr{ a^\dagger - a} \\
a(t) &= a(0) e^{-i \omega t} \\
a(0) \ket{n} &= \sqrt{n} \ket{n-1} \\
a^\dagger(0) \ket{n} &= \sqrt{n+1} \ket{n+1} \\
x_0^2 &= \frac{\Hbar}{\omega m},
\end{aligned}
\end{equation}

we have

\begin{dmath}\label{eqn:shoExpectations:40}
\bra{m} x \ket{n}
=
\frac{x_0}{\sqrt{2}} \bra{m} \lr{ a + a^\dagger } \ket{n}
=
\frac{x_0}{\sqrt{2}} \bra{m}
\lr{
e^{-i \omega t} \sqrt{n} \ket{n-1}
+
e^{i \omega t} \sqrt{n+1} \ket{n+1}
}
=
\frac{x_0}{\sqrt{2}} \lr{
\delta_{m, n-1} e^{-i \omega t} \sqrt{n}
+
\delta_{m, n+1} e^{i \omega t} \sqrt{n+1}
},
\end{dmath}

\begin{dmath}\label{eqn:shoExpectations:60}
\bra{m} x^2 \ket{n}
=
\frac{x_0^2}{2} \bra{m} \lr{ a + a^\dagger }^2 \ket{n}
=
\frac{x_0^2}{2}
\lr{
e^{i \omega t} \sqrt{m} \bra{m-1}
+
e^{-i \omega t} \sqrt{m+1} \bra{m+1}
}
\lr{
e^{-i \omega t} \sqrt{n} \ket{n-1}
+
e^{i \omega t} \sqrt{n+1} \ket{n+1}
}
=
\frac{x_0^2}{2}
\lr{
\delta_{m+1,n+1} \sqrt{(m+1)(n+1)}
+\delta_{m+1,n-1} \sqrt{(m+1)n} e^{-2 i \omega t}
+\delta_{m-1,n+1} \sqrt{m(n+1)} e^{2 i \omega t}
+\delta_{m-1,n-1} \sqrt{m n}
},
\end{dmath}

\begin{dmath}\label{eqn:shoExpectations:80}
\bra{m} p \ket{n}
=
\frac{i\Hbar}{\sqrt{2} x_0} \bra{m} \lr{ a^\dagger - a} \ket{n}
=
\frac{i\Hbar}{\sqrt{2} x_0} \bra{m} \lr{
e^{i \omega t} \sqrt{n+1} \ket{n+1}
-
e^{-i \omega t} \sqrt{n} \ket{n-1}
}
=
\frac{i\Hbar}{\sqrt{2} x_0} \lr{
\delta_{m,n+1} e^{i \omega t} \sqrt{n+1}
-
\delta_{m,n-1} e^{-i \omega t} \sqrt{n}
},
\end{dmath}

\begin{dmath}\label{eqn:shoExpectations:100}
\bra{m} p^2 \ket{n}
=
\frac{\Hbar^2}{2 x_0^2} \ket{m} \lr{ a - a^\dagger }  \lr{ a^\dagger - a} \ket{n}
=
\frac{\Hbar^2}{2 x_0^2}
\lr{
-e^{-i \omega t} \sqrt{m+1} \bra{m+1}
+
e^{i \omega t} \sqrt{m} \bra{m-1}
}
\lr{
e^{i \omega t} \sqrt{n+1} \ket{n+1}
-
e^{-i \omega t} \sqrt{n} \ket{n-1}
}
=
\frac{\Hbar^2}{2 x_0^2}
\lr{
\delta_{m+1,n+1} \sqrt{(m+1)(n+1)}
+\delta_{m+1,n-1} \sqrt{(m+1)n} e^{-2 i \omega t}
+\delta_{m-1,n+1} \sqrt{m(n+1)} e^{2 i \omega t}
+\delta_{m-1,n-1} \sqrt{m n}
}.
\end{dmath}

For the anticommutator \( \symmetric{x}{p} \), we have

\begin{dmath}\label{eqn:shoExpectations:120}
\symmetric{x}{p}
=
\frac{i\Hbar}{2}
\lr{
\lr{ a e^{-i \omega t} + a^\dagger e^{i \omega t} } \lr{ a^\dagger e^{i \omega t} - a e^{-i \omega t} }
-
\lr{ a^\dagger e^{i \omega t} - a e^{-i \omega t} }
\lr{ a e^{-i \omega t} + a^\dagger e^{i \omega t} }
}
=
\frac{i\Hbar}{2}
\lr{
- a^2 e^{- 2 i \omega t}
+ (a^\dagger)^2 e^{ 2 i \omega t}
+ a a^\dagger
- a^\dagger a
+ a^2 e^{- 2 i \omega t}
- (a^\dagger)^2 e^{ 2 i \omega t}
- a^\dagger a
+ a a^\dagger
}
=
i\Hbar
\lr{
a a^\dagger - a^\dagger a
},
\end{dmath}

so

\begin{dmath}\label{eqn:shoExpectations:140}
\bra{m} \symmetric{x}{p} \ket{n}
=
i\Hbar
\bra{m}
\lr{
a a^\dagger - a^\dagger a
}
\ket{n}
=
i\Hbar
\bra{m}
\lr{
\sqrt{(n+1)^2}\ket{n}
-\sqrt{n^2}\ket{n}
}
=
i\Hbar
\bra{m}
\lr{
2 n + 1
}
\ket{n}.
\end{dmath}

\makeSubAnswer{}{problem:shoExpectations:1:b}

For the SHO, the virial theorem requires \( \expectation{p^2/m} = \expectation{m \omega x^2} \).  That momentum expectation with respect to the eigenstate \( \ket{n} \) is

\begin{dmath}\label{eqn:shoExpectations:160}
\expectation{p^2/m}
=
\frac{\Hbar^2}{2 x_0^2 m}
\lr{
\sqrt{(n+1)(n+1)}
+
\sqrt{n n}
}
=
\frac{\Hbar^2 m \omega}{2 \Hbar m} \lr{ 2 n + 1 }
=
\Hbar \omega \lr{ n + \inv{2} }.
\end{dmath}

For the position expectation we've got

\begin{dmath}\label{eqn:shoExpectations:180}
\expectation{m \omega x^2}
=
\frac{m \omega^2 x_0^2}{2}
\lr{
\sqrt{(n+1)(n+1)}
+ \sqrt{n n}
}
=
\frac{m \omega^2 \Hbar}{2 m \omega}
\lr{
\sqrt{(n+1)(n+1)}
+ \sqrt{n n}
}
=
\frac{\omega \Hbar}{2 }
\lr{ 2 n + 1 }
=
\omega \Hbar
\lr{ n + \inv{2} }.
\end{dmath}

This shows that the virial theorem holds for the SHO Hamiltonian for eigenstates.

} % answer

%\EndArticle
