%
% Copyright © 2015 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{qmVirialTheorem}
%\renewcommand{\dirname}{notes/phy1520/}
%%\newcommand{\dateintitle}{}
%%\newcommand{\keywords}{}
%
%\input{../peeter_prologue_print2.tex}
%
%\usepackage{peeters_layout_exercise}
%\usepackage{peeters_braket}
%\usepackage{peeters_figures}
%
%\beginArtNoToc
%
%\generatetitle{Quantum Virial Theorem}
%\chapter{Quantum Virial Theorem}
%\label{chap:qmVirialTheorem}

\makeoproblem{Quantum virial Theorem.}{problem:qmVirialTheorem:7}{\citep{sakurai2014modern} pr. 2.7}{
\index{virial theorem}
Consider a particle with Hamiltonian

\begin{dmath}\label{eqn:qmVirialTheorem:20}
H = \frac{\Bp^2}{2 m} + V(\Bx),
\end{dmath}

By calculating the time evolution of \( \antisymmetric{\Bx \cdot \Bp}{H} \), identify the quantum virial theorem and show the conditions where it is satisfied.

} % problem

\makeanswer{problem:qmVirialTheorem:7}{

\begin{dmath}\label{eqn:qmVirialTheorem:40}
\antisymmetric{\Bx \cdot \Bp}{H}
=
\inv{2 m} \antisymmetric{\Bx \cdot \Bp}{\Bp^2} + \antisymmetric{\Bx \cdot \Bp}{V(\Bx)}
=
\inv{2 m} \lr{ x_r p_r \Bp^2 - \Bp^2 x_r p_r}
+
\lr{ x_r p_r V(\Bx) - V(\Bx) x_r p_r }
=
\inv{2 m} \antisymmetric{ x_r }{\Bp^2} p_r
+
x_r \antisymmetric{ p_r}{ V(\Bx)},
\end{dmath}

Evaluating those commutators separately, gives

\begin{dmath}\label{eqn:qmVirialTheorem:60}
\begin{aligned}
\antisymmetric{ x_r }{\Bp^2}
&=
\antisymmetric{ x_r }{p_r^2}\qquad \text{no sum} \\
&=
2 i \Hbar p_r,
\end{aligned}
\end{dmath}

and

\begin{dmath}\label{eqn:qmVirialTheorem:80}
\antisymmetric{ p_r}{ V(\Bx)}
= -i \Hbar \PD{x_r}{V(\Bx)},
\end{dmath}

so
\begin{dmath}\label{eqn:qmVirialTheorem:100}
\ddt{}\lr{\Bx \cdot \Bp}
=
\inv{i \Hbar}
\antisymmetric{\Bx \cdot \Bp}{H}
=
\inv{2 m} 2 p_r p_r - x_r \PD{x_r}{V(\Bx)}
=
\frac{\Bp^2}{m} - \Bx \cdot \spacegrad V(\Bx).
\end{dmath}

Taking expectation values, assuming that the states are independent of time, we have

\begin{dmath}\label{eqn:qmVirialTheorem:120}
0
= \ddt{} \expectation{ \Bx \cdot \Bp }
= \expectation{\frac{\Bp^2}{m}} - \expectation{\Bx \cdot \spacegrad V(\Bx)}.
\end{dmath}

Note that taking the expectation with respect to stationary states was required to reverse the order of the time derivative with the expectation operation.

The right hand side is the quantum equivalent of the virial theorem, relating the average kinetic energy to the potential

\begin{dmath}\label{eqn:qmVirialTheorem:140}
2 \expectation{T} = \expectation{\Bx \cdot \spacegrad V(\Bx)}
\end{dmath}

} % answer

%\EndArticle
